
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Big Data utilities for WSPR DataSets">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.2">
    
    
      
        <title>Basic Examples - WSPR Analytics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.73f7c429.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#basic-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="WSPR Analytics" class="md-header-nav__button md-logo" aria-label="WSPR Analytics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            WSPR Analytics
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Basic Examples
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/KI7MT/wspr-analytics" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    KI7MT/wspr-analytics
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tools/overview/" class="md-tabs__link">
        Tools
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../spark/overview/" class="md-tabs__link">
        Spark
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../overview/" class="md-tabs__link md-tabs__link--active">
        PySpark
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../rscripts/overview/" class="md-tabs__link">
        R-Scripts
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../notebooks/overview/" class="md-tabs__link">
        Jupyter
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../wsprdaemon/overview/" class="md-tabs__link">
        WSPR-Daemon
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WSPR Analytics" class="md-nav__button md-logo" aria-label="WSPR Analytics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    WSPR Analytics
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/KI7MT/wspr-analytics" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    KI7MT/wspr-analytics
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      Tools
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tools" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-python/" class="md-nav__link">
      Installing Python
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-java/" class="md-nav__link">
      Installing Java
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-sdkman/" class="md-nav__link">
      Installing Sdkman
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-spark/" class="md-nav__link">
      Installing Spark
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-scala/" class="md-nav__link">
      Installing Scala
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-r/" class="md-nav__link">
      Installing R
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-grafana/" class="md-nav__link">
      Installing Graphana
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tools/install-postgresql/" class="md-nav__link">
      Installing PostgreSQL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      Spark
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Spark" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Spark
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../spark/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../spark/convert-csv-parquet/" class="md-nav__link">
      Convert To Parquet
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../spark/query-with-parquet/" class="md-nav__link">
      Query With Parquet
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../spark/top-ten-reporters/" class="md-nav__link">
      Top Ten Reporters
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../spark/spark-examples/" class="md-nav__link">
      Spark Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      PySpark
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="PySpark" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        PySpark
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Basic Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Basic Examples
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compute-constraints" class="md-nav__link">
    Compute Constraints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute-environment" class="md-nav__link">
    Compute Environment
  </a>
  
    <nav class="md-nav" aria-label="Compute Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    Java
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    Python
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdk-manager" class="md-nav__link">
    SDK Manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-tests" class="md-nav__link">
    Running The Tests
  </a>
  
    <nav class="md-nav" aria-label="Running The Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pandas-parquet-compression-test" class="md-nav__link">
    Pandas Parquet Compression Test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache-arrow-pyarrow-read-test" class="md-nav__link">
    Apache Arrow (PyArrow) Read Test
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    
    <label class="md-nav__link" for="nav-5">
      R-Scripts
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="R-Scripts" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        R-Scripts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../rscripts/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
    
    <label class="md-nav__link" for="nav-6">
      Jupyter
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Jupyter" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Jupyter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../notebooks/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
    
    <label class="md-nav__link" for="nav-7">
      WSPR-Daemon
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="WSPR-Daemon" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        WSPR-Daemon
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../wsprdaemon/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compute-constraints" class="md-nav__link">
    Compute Constraints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compute-environment" class="md-nav__link">
    Compute Environment
  </a>
  
    <nav class="md-nav" aria-label="Compute Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    Java
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    Python
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sdk-manager" class="md-nav__link">
    SDK Manager
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-tests" class="md-nav__link">
    Running The Tests
  </a>
  
    <nav class="md-nav" aria-label="Running The Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pandas-parquet-compression-test" class="md-nav__link">
    Pandas Parquet Compression Test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache-arrow-pyarrow-read-test" class="md-nav__link">
    Apache Arrow (PyArrow) Read Test
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="basic-examples">Basic Examples<a class="headerlink" href="#basic-examples" title="Permanent link">&para;</a></h1>
<p>The scripts in this directory are used for exploring the use of <a href="https://spark.apache.org/">Spark</a>, <a href="https://arrow.apache.org/">Apache Arrow</a>,
<a href="https://www.scala-lang.org/">Scala</a> and other Big Data frameworks to: </p>
<ol>
<li>Reduce WSPR CSV on-disk storage space</li>
<li>Improve CSV read times and portability</li>
<li>Improve query performance</li>
<li>Produce a cost effective, yet scalable, analytics solution for WSPR data</li>
</ol>
<p>An additional dimension that could be explored is streaming. For those with
suffecient energy, there are many frameworks that can be employed in this
area:</p>
<ul>
<li><a href="https://storm.apache.org/">Apache Storm</a></li>
<li><a href="https://spark.apache.org/streaming/">Spark Streaming</a></li>
<li><a href="https://flink.apache.org/">Apache Flink</a></li>
</ul>
<p>...and many others.</p>
<p>All of the example scripts will be incorporated into a main application at some point,
however, some will just be for testing.</p>
<p>Additional tests will be done using <a href="https://www.scala-lang.org/">Scala</a> and / or <a href="https://adoptopenjdk.net/">Java</a> for performance
cvomparison. Initial tests will be run using Python, or more sustinct, <a href="https://databricks.com/glossary/pyspark">PySpark</a>,
as it lends itself to rapid-deployment scenarios.</p>
<blockquote>
<p>NOTE: This exercise is not a full-blown scientific experiment. Rather, its more
of a feasability or proof of concept exercise.</p>
</blockquote>
<h2 id="compute-constraints">Compute Constraints<a class="headerlink" href="#compute-constraints" title="Permanent link">&para;</a></h2>
<p>While there is no shortage of cloud-based Big Data solutions these days ( 
[AWS EMR][], <a href="https://azure.microsoft.com/en-us/services/synapse-analytics/">Azure Synapse</a>, <a href="https://databricks.com/">Databricks</a>, <a href="https://cloud.google.com/compute/">GCP</a>, <a href="https://cloud.google.com/bigquery/">Google Big Query</a>, etc),
these tests will look at commonidty based on-prem resources in order to keep
the overall cost to an acceptable level. In other words: a hefty workstation,
a stack of Raspberry PI's, or an over-powered laptop should be capable of
performing the tasks for the use case at hand.</p>
<h2 id="compute-environment">Compute Environment<a class="headerlink" href="#compute-environment" title="Permanent link">&para;</a></h2>
<p>If you are on <code>Windows 10</code>, I would highly recommended using <code>Windows Subsystem Linux v2</code>.
Doing so will make setting up <a href="https://spark.apache.org/PySpark">Apache Spark</a> much easier, and you can follow
the directions below with mininal frustration.</p>
<h3 id="java">Java<a class="headerlink" href="#java" title="Permanent link">&para;</a></h3>
<p>No matter which method of compute is employed, <a href="https://adoptopenjdk.net/">Java</a> forms the foundation.
I chose to use <code>openjdk version 1.8.0_275</code>, however, <a href="https://spark.apache.org/">Spark</a> now fully
supports <code>Java-11</code>. I've also ran <code>Java-14</code>, but prefer to stick with LTS
versions becasue not all frameworks support the <code>"latest and greatest"</code> JVM.</p>
<h3 id="python">Python<a class="headerlink" href="#python" title="Permanent link">&para;</a></h3>
<p>You need a <code>Python</code> environment, either from <a href="https://www.anaconda.com/">Anaconda Python</a> or the standard
<a href="https://www.python.org">Python</a> installer and <code>venv</code>. Either way, you should run the tests in a virtual
Python environment to keep these packages from interfering with your core
operating system.</p>
<h3 id="sdk-manager">SDK Manager<a class="headerlink" href="#sdk-manager" title="Permanent link">&para;</a></h3>
<p>While running tests, it can be frustraighting to manage the large matrix of
frameworks. The use of <a href="https://sdkman.io/">sdkman</a> can make quick work of this chore; it's up to
you though.</p>
<h2 id="running-the-tests">Running The Tests<a class="headerlink" href="#running-the-tests" title="Permanent link">&para;</a></h2>
<p>The first two tests will illustrate the speed increase by using <a href="https://arrow.apache.org/">Apache Arrow</a>
to process both CSV and <a href="https://parquet.apache.org/">Apache Parquet</a> compressed binaries. The major difference
between the native CSV file, and those compressed by the <code>pandas_convert_csv.py</code>
script is, the CSV file has no schema header information accompanying the file
whereas the <a href="https://parquet.apache.org/">Apache Parquet</a> binaries have full headers and data-type structures
defined. Using inferred-schema does work, but it is not without error.
This is the primary reason to fully define the schemas beforehand.</p>
<p><a href="https://pandas.pydata.org/">Pandas</a>, buy default, is a single thread reader/writer. It can be made to
pool, but it's not configured to do so out of the box. You will see the
difference in reading raw CSV files during the compression
run and that of <a href="https://arrow.apache.org/">Apache Arrow</a> (e.g. PyArrow with Python) running in parallel
doing the same task.</p>
<p>To run the test scripts, perform the following:</p>
<ul>
<li>Download and extract a WSPR Archive</li>
<li>Clone the <a href="https://github.com/KI7MT/wspr-analytics">wspr-analytics</a> repository</li>
<li>Set a path variable</li>
<li>Install Python package requirments</li>
<li>Runs the test scripts</li>
</ul>
<p>Here are the <code>Bash</code> commands I used to run the tests.</p>
<pre><code class="language-bash"># change the download location to whatever you prefer
cd ~/Downloads
wget -c http://wsprnet.org/archive/wsprspots-2020-02.csv.gz
gzip -dk wsprspots-2020-02.csv.gz

# set the path of the downloaded and extracted CSV file
csvfile=$PWD/wsprspots-2020-02.csv

# clone the repo
git clone https://github.com/KI7MT/wspr-analytics.git

# change directories and install dependencies
cd ~/Downloads/wspr-analytics/experiments

# NOTE: Be sure you are in a virtual environment &quot;before&quot;
# installing Python packages
python -m pip install -r requirement.txt

# run the conversion script
python pandas_convert_csv.py -f $csvfile
</code></pre>
<h3 id="pandas-parquet-compression-test">Pandas Parquet Compression Test<a class="headerlink" href="#pandas-parquet-compression-test" title="Permanent link">&para;</a></h3>
<ul>
<li><code>CSV Reader</code> - Python Pandas</li>
<li><code>Parquet Writer</code> - Python Pandas To Parquet</li>
</ul>
<blockquote>
<p>NOTE: Additional tests will be added to check the read/write
speeds using <a href="https://arrow.apache.org/">Apache Arrow</a> only while leaving <a href="https://pandas.pydata.org/">Pandas</a>
out of the mix completely.</p>
</blockquote>
<p>The following data shows the results of converting a CSV file to 
several <a href="https://parquet.apache.org/">Apache Parquet</a> formats. Substantial disk-space
savings can be achived using these methods.</p>
<p>Generally speaking, as the compression increases so does the length
of time it takes to create the file. However, the disk-space savings
are impressive.</p>
<blockquote>
<p>NOTE : Make note of the CSV Read Time while using <a href="https://pandas.pydata.org/">Pandas</a> in a <code>Single Thead</code> </p>
</blockquote>
<p>Disk space savings range from <code>&gt;= 5 : 1</code> to <code>8 : 1</code> depending on the compression
you'd like to use. It's a <code>substantial</code> savings no matter which you chose.</p>
<pre><code class="language-bash">Pandas CSV Conversion Method
Parquet Compression Types : ['SNAPPY', 'LZ4', 'ZSTD', 'GZIP', 'BROTLI']
Sit back and relax, this takes a while!!

* Reading file  : wsprspots-2020-02.csv
* Spot Count    : 47,310,649
* File Size     : 3780.94 MB
* Elapsed Time  : 79.448 sec

* Converting CSV to -&gt; snappy
* File Size     : 667.07 MB
* Elapsed Time  : 29.579 sec

* Converting CSV to -&gt; lz4
* File Size     : 627.88 MB
* Elapsed Time  : 29.702 sec

* Converting CSV to -&gt; zstd
* File Size     : 520.19 MB
* Elapsed Time  : 30.778 sec

* Converting CSV to -&gt; gzip
* File Size     : 467.55 MB
* Elapsed Time  : 107.244 sec

* Converting CSV to -&gt; brotli
* File Size     : 446.58 MB
* Elapsed Time  : 89.529 sec

NOTE : The File Sizes Are Approximated = (file bytes / 1048576)

Finished !!
</code></pre>
<h3 id="apache-arrow-pyarrow-read-test">Apache Arrow (PyArrow) Read Test<a class="headerlink" href="#apache-arrow-pyarrow-read-test" title="Permanent link">&para;</a></h3>
<ul>
<li><code>Reader</code> - PyArrow</li>
</ul>
<p>The results below are from using <a href="https://arrow.apache.org/">Apache Arrow</a> to read each of the
compressed-file formats created above.</p>
<p>No Spark nodes are deployed, only a single master with no special
optimizations applied. <a href="https://arrow.apache.org/">Apache Arrow</a> uses threads by default which
is the main difference in using <a href="https://pandas.pydata.org/">Pandas</a> to read original CSV read.</p>
<p>To say it's fast is an understatement.</p>
<blockquote>
<p>NOTE : Check the CSV Read Time below and compare it to the <a href="https://pandas.pydata.org/">Pandas</a>
CSV read time from above; it's an <code>36 : 1</code> read-speed improvement or
( <code>80.32 sec</code> v.s. <code>2.213 sec</code> )</p>
</blockquote>
<pre><code class="language-bash"># You run the read script the same way
python pyarrow_read.py -f $csvfile

# Results:

Running Read Tests Using Apache Arrow
Compression Types : ['CSV', 'SNAPPY', 'ZSTD', 'GZIP', 'BROTLI']

* Reading file  : wsprspots-2020-02.csv
* File Size     : 3780.94 MB
* Elapsed Time  : 2.185

* Reading file  : wsprspots-2020-02.snappy
* File Size     : 667.07 MB
* Elapsed Time  : 2.011

* Reading file  : wsprspots-2020-02.zstd
* File Size     : 520.19 MB
* Elapsed Time  : 1.769

* Reading file  : wsprspots-2020-02.gzip
* File Size     : 467.55 MB
* Elapsed Time  : 3.654

* Reading file  : wsprspots-2020-02.brotli
* File Size     : 446.58 MB
* Elapsed Time  : 2.102

 Finished !!
</code></pre>
<h1 id="query-parquet-file-using-pyspark">Query Parquet File Using PySpark<a class="headerlink" href="#query-parquet-file-using-pyspark" title="Permanent link">&para;</a></h1>
<p>The next phase is to run a simple query using <a href="https://databricks.com/glossary/pyspark">PySpark</a> in<br />
in a distributed manner.</p>
<p>As this is all happening on a single msater host node, it is more
of a parralized action rather than distributed, but the results are
far superior to what any single threaded implementation could achieve.</p>
<p>See <a href="https://github.com/KI7MT/wspr-analytics/blob/main/notebooks/WSPR-Query-Using-PySpark.ipynb">WSPR Query Notebook</a> for details.</p>
<p>The read speed is impressive. It takes <code>~1.5</code> seccond to read
<code>47+ Million</code> rows, and <code>~4.8</code> seconds to do a group by query.</p>
<p>Row count speeds (  <code>0.87 sec</code> ) are on par with using ( <code>wc -l</code> )
from a Linux shell.</p>
<p>Now matter how one looks at this approach, it's a viable alternative
to a raw csv read and process action.</p>
<pre><code class="language-bash">* Reading file ..: wsprspots-2020-02.parquet
* File Size .....: 490,259,730 bytes compressed
* Read Time .....: 1.51834 sec

* Counting Records
* Record Count ..: 47,310,649
* Count Time ....: 0.90268 sec

* Running Group by Count Query and return the dataframe
+--------+------+
|Reporter| count|
+--------+------+
|   DK6UG|838081|
|  OE9GHV|690104|
|  EA8BFK|648670|
|   KD2OM|589003|
|KA7OEI-1|576788|
|   K4RCG|571445|
|     KPH|551690|
|    K9AN|480759|
|   DF5FH|480352|
|   DJ9PC|474211|
+--------+------+
only showing top 10 rows

* Query Time ....: 4.94034 sec
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../overview/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </div>
            </div>
          </a>
        
        
          <a href="../../rscripts/overview/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020 Greg Beam
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>